# AdsPower RPA Authorization Checker

Новый проект для автоматизированной проверки авторизации аккаунтов в AdsPower через локальный API.
Он создаёт сценарий RPA, который открывает Discord, оценивает состояние входа и собирает ключевые данные
(никнейм, серийный номер профиля). Проект легко расширяется под другие сервисы за счёт конфигурации.

## Возможности

- Асинхронная проверка нескольких профилей с ограничением параллелизма.
- Гибкая настройка CSS‑селекторов, указывающих на авторизацию/разлогин, и селекторов отображаемого имени.
- Поддержка произвольного количества профилей и их человеко-понятных меток.
- Вывод результатов в удобной табличной форме через `rich`.

## Структура проекта

- `src/adspower_rpa/` — исходный код клиента, оркестратора и генератора RPA-сценария.
- `adspower.yaml` — пример конфигурации.
- `pyproject.toml` — метаданные и зависимости проекта.

## Установка

```bash
python -m venv .venv
source .venv/bin/activate
pip install -e .
```

## Настройка

1. Скопируйте `adspower.yaml` и укажите корректные значения:
   - `base_url` — адрес локального API AdsPower (по умолчанию `http://local.adspower.net:50325`).
   - `api_key` — если включена авторизация API, добавьте значение в конфиг (параметр необязателен).
   - `profiles` — список серийных номеров/ID профилей.
   - `selectors` — при необходимости измените селекторы для сервиса.

2. Убедитесь, что AdsPower запущен, и необходимые профили доступны.

## Запуск

```bash
adspower-check --config adspower.yaml
```

CLI выполнит сценарий для каждого профиля, а затем выведет таблицу с полями:

- **Profile ID** — серийный номер профиля в AdsPower.
- **Label** — метка, указанная в конфиге.
- **Authorized** — `Yes`, если страница определена как авторизованная.
- **Display name** — найденный никнейм пользователя.
- **Error** — сообщение об ошибке, если сценарий завершился неуспешно.

## Модификация сценария

Файл `src/adspower_rpa/scenarios.py` содержит генератор сценария. Он использует
конфигурацию селекторов и URL, поэтому для других сервисов достаточно скорректировать секцию
`service` в конфиге либо расширить модуль собственным builder'ом.

## Интеграция

- Сценарий отправляется в AdsPower методом `POST /api/v1/automation/run`.
- Клиент автоматически добавляет заголовок `Authorization` при наличии API-ключа.
- При необходимости можно адаптировать код для записи результатов в внешние системы
  (Google Sheets, базы данных и т.д.) — достаточно модифицировать `checker.py`.

## Лицензия

Проект распространяется без лицензии. Используйте и адаптируйте под свои задачи.
